---
title: Kotlin x Gradle ã®ãƒãƒ«ãƒãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½œã‚Šæ–¹
tags:
  - Kotlin
  - gradle
private: false
updated_at: '2023-02-10T21:59:46+09:00'
id: 0f58811b53c154bd9b12
organization_url_name: null
slide: false
---
ã€å®Œèµ°è³ã€‘MxShun ã²ã¨ã‚Šãƒãƒ©ã‚½ãƒ³ ğŸƒ Advent Calendar 2022ã€€æ¯é€±é‡‘æ›œæ—¥ã¯ Kotlin ã®è¨˜äº‹ã‚’æ›¸ã“ã†ï¼1è¨˜äº‹ç›®ã§ã™ã€‚

ä»Šå›ã¯ã€ŒKotlin x Gradle ã®ãƒãƒ«ãƒãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½œã‚Šæ–¹ã€ã‚’è¨˜äº‹ã«ã—ã‚ˆã†ã¨æ€ã„ã¾ã™ã€‚
ã¨æ€ã£ãŸã‚“ã§ã™ãŒã€Gradle v6.7 ã§æ—¢ã«è¿½åŠ ã•ã‚Œã¦ã„ã‚‹æ©Ÿèƒ½ã§ã—ãŸã€‚çŸ¥ã‚‰ãªã‹ã£ãŸã€‚å±ã†ãç„¡çŸ¥ã‚’æ™’ã™ã¨ã“ã‚ã§ã—ãŸã€‚

æ—©é€Ÿã§ã™ãŒã€Kotlin x Gradle ã®ãƒãƒ«ãƒãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½œã‚Šæ–¹ã§ã™ã€‚

```bash
$ gradle init

Select type of project to generate:
  1: basic
  2: application
  3: library
  4: Gradle plugin
Enter selection (default: basic) [1..4] 2

Select implementation language:
  1: C++
  2: Groovy
  3: Java
  4: Kotlin
  5: Scala
  6: Swift
Enter selection (default: Java) [1..6] 3

Split functionality across multiple subprojects?:
   1: no - only one application project
   2: yes - application and library projects
Enter selection [1..2] 2
```

æœ€å¾Œã® `Split functionality across multiple subprojects?` ãŒãƒãƒ«ãƒãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåŒ–ã‚’ã™ã‚‹ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ã™ã€‚ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã¯ã‚·ãƒ³ã‚°ãƒ«ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã™ã€‚ï¼‰

https://docs.gradle.org/6.7/release-notes.html

ãªã®ã§ã€æœ¬è¨˜äº‹ã§ã¯ãƒãƒ«ãƒãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½•ãŒå¬‰ã—ã„ã®ã‹ ã¨ ãƒãƒ«ãƒãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåŒ–ã‚’ã™ã‚‹ã“ã¨ã§ Gradle ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ã©ã®ã‚ˆã†ãªå¤‰åŒ–ãŒèµ·ããŸã‹ã‚’ã‚‚ã†ã¡ã‚‡ã£ã¨æ›¸ã“ã†ã¨æ€ã„ã¾ã™ã€‚

### ãƒãƒ«ãƒãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½•ãŒå¬‰ã—ã„ã®ã‹
ç¬¬ä¸€ã«ã€1ã¤ã® Gradle ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå†…ã§è¤‡æ•°ã® Gradle ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’å®šç¾©ã§ãã‚‹ã®ã§ã€ã“ã‚Œã¾ã§ã¯è¤‡æ•°ã®ãƒªãƒã‚¸ãƒˆãƒªç®¡ç†ã—ã¦ã„ãŸä¾å­˜ã™ã‚‹ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä¸€ã¤ã«ã¾ã¨ã‚ã‚‹ã“ã¨ãŒã§ãã¾ã™ã­ã€‚

ç¬¬äºŒã«ã€ãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒ‰ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã«ä»£è¡¨ã•ã‚Œã‚‹ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«é–“ã®ä¾å­˜åˆ¶å¾¡ãŒå¿…è¦ãªãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ç®¡ç†ã—ã‚„ã™ããªã‚Šã¾ã™ã­ã€‚ç‰¹ã« Kotlin x Gradle ã®æ–‡è„ˆã§ã„ã†ã¨ã‚¿ã‚±ãƒã‚¿ã•ã‚“ã®ãƒ–ãƒ­ã‚°ãŒå‚è€ƒã«ãªã‚‹ã‹ã¨ã€‚

https://blog.takehata-engineer.com/entry/realizing-an-onion-architecture-in-kotlin-and-spring-boot-with-gradle-multi-project

### ãƒãƒ«ãƒãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåŒ–ã«ã‚ˆã£ã¦èµ·ã“ã£ãŸå¤‰åŒ–
ã¾ãšã¯ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ã€‚åŒã˜åå‰ã§ one application ã¨ multiple subprojects ã‚’ä½œæˆã— tree ã‚’æ¯”è¼ƒã—ã¦ã¿ã¾ã™ã€‚

- one application

ã†ã‚“ã€çœŸã£ç™½ãªãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã™ã­ã€‚

```bash
multi-projects
|--.gitattributes
|--.gitignore
|--.gradle
|  |--ã€€// çœç•¥
|--app
|  |--build.gradle.kts
|  |--src
|  |  |--main
|  |  |  |--kotlin
|  |  |  |  |--multi
|  |  |  |  |  |--projects
|  |  |  |  |  |  |--App.kt
|  |  |  |--resources
|  |  |--test
|  |  |  |--kotlin
|  |  |  |  |--multi
|  |  |  |  |  |--projects
|  |  |  |  |  |  |--AppTest.kt
|  |  |  |--resources
|--gradle
|  |--wrapper
|  |  |--gradle-wrapper.jar
|  |  |--gradle-wrapper.properties
|--gradlew
|--gradlew.bat
|--settings.gradle.kts
```

- multiple subprojects

`app` ã«åŠ ãˆ `list` ã¨ `utilities` ã¨ã„ã†ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚‚ç”Ÿæˆã•ã‚Œã¦ã„ã¾ã™ã€‚ãã—ã¦ã€ãã‚Œãã‚ŒãŒãƒ‘ãƒƒã‚±ãƒ¼ã‚¸æ§‹é€ ã¨ `build.gradle.kts` ã‚’å†…åŒ…ã—ã¦ã„ã¾ã™ã€‚

```bash
multi-projects
|--.gitattributes
|--.gitignore
|--.gradle
|  |-- // çœç•¥
|--app
|  |--build.gradle.kts
|  |--src
|  |  |--main
|  |  |  |--kotlin
|  |  |  |  |--multi
|  |  |  |  |  |--projects
|  |  |  |  |  |  |--app
|  |  |  |  |  |  |  |--App.kt
|  |  |  |  |  |  |  |--MessageUtils.kt
|  |  |  |--resources
|  |  |--test
|  |  |  |--kotlin
|  |  |  |  |--multi
|  |  |  |  |  |--projects
|  |  |  |  |  |  |--app
|  |  |  |  |  |  |  |--MessageUtilsTest.kt
|  |  |  |--resources
|--buildSrc
|  |--build.gradle.kts
|  |--src
|  |  |--main
|  |  |  |--kotlin
|  |  |  |  |--multi.projects.kotlin-application-conventions.gradle.kts
|  |  |  |  |--multi.projects.kotlin-common-conventions.gradle.kts
|  |  |  |  |--multi.projects.kotlin-library-conventions.gradle.kts
|--gradle
|  |--wrapper
|  |  |--gradle-wrapper.jar
|  |  |--gradle-wrapper.properties
|--gradlew
|--gradlew.bat
|--list
|  |--build.gradle.kts
|  |--src
|  |  |--main
|  |  |  |--kotlin
|  |  |  |  |--multi
|  |  |  |  |  |--projects
|  |  |  |  |  |  |--list
|  |  |  |  |  |  |  |--LinkedList.kt
|  |  |  |--resources
|  |  |--test
|  |  |  |--kotlin
|  |  |  |  |--multi
|  |  |  |  |  |--projects
|  |  |  |  |  |  |--list
|  |  |  |  |  |  |  |--LinkedListTest.kt
|  |  |  |--resources
|--settings.gradle.kts
|--utilities
|  |--build.gradle.kts
|  |--src
|  |  |--main
|  |  |  |--kotlin
|  |  |  |  |--multi
|  |  |  |  |  |--projects
|  |  |  |  |  |  |--utilities
|  |  |  |  |  |  |  |--JoinUtils.kt
|  |  |  |  |  |  |  |--SplitUtils.kt
|  |  |  |  |  |  |  |--StringUtils.kt
|  |  |  |--resources
|  |  |--test
|  |  |  |--resources
```

ç¶šã„ã¦ã€Gradle ã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®å·®ç•°ã‚’è¦‹ã¦ã¿ã¾ã™ã€‚ã¾ãšã¯ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã® `settings.gradle.kts` ã‚’ã€‚

- one application

```
/*
 * This file was generated by the Gradle 'init' task.
 *
 * The settings file is used to specify which projects to include in your build.
 *
 * Detailed information about configuring a multi-project build in Gradle can be found
 * in the user manual at https://docs.gradle.org/7.0/userguide/multi_project_builds.html
 */

rootProject.name = "multi-projects"
include("app")
```

- multiple subprojects

`app` ã«åŠ ãˆ `list` `utilities` ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚‚å†…åŒ…ã™ã‚‹ã“ã¨ãŒè¿½åŠ å®šç¾©ã•ã‚Œã¦ã„ã¾ã™ã€‚

```
/*
 * This file was generated by the Gradle 'init' task.
 *
 * The settings file is used to specify which projects to include in your build.
 *
 * Detailed information about configuring a multi-project build in Gradle can be found
 * in the user manual at https://docs.gradle.org/7.0/userguide/multi_project_builds.html
 */

rootProject.name = "multi-projects"
include("app", "list", "utilities")
```

æ¬¡ã« `build.gradle.kts` ã‚’ã€‚

- one application

```
/*
 * This file was generated by the Gradle 'init' task.
 *
 * This generated file contains a sample Kotlin application project to get you started.
 * For more details take a look at the 'Building Java & JVM projects' chapter in the Gradle
 * User Manual available at https://docs.gradle.org/7.0/userguide/building_java_projects.html
 */

plugins {
    // Apply the org.jetbrains.kotlin.jvm Plugin to add support for Kotlin.
    id("org.jetbrains.kotlin.jvm") version "1.4.31"

    // Apply the application plugin to add support for building a CLI application in Java.
    application
}

repositories {
    // Use Maven Central for resolving dependencies.
    mavenCentral()
}

dependencies {
    // Align versions of all Kotlin components
    implementation(platform("org.jetbrains.kotlin:kotlin-bom"))

    // Use the Kotlin JDK 8 standard library.
    implementation("org.jetbrains.kotlin:kotlin-stdlib-jdk8")

    // This dependency is used by the application.
    implementation("com.google.guava:guava:30.0-jre")

    // Use the Kotlin test library.
    testImplementation("org.jetbrains.kotlin:kotlin-test")

    // Use the Kotlin JUnit integration.
    testImplementation("org.jetbrains.kotlin:kotlin-test-junit")
}

application {
    // Define the main class for the application.
    mainClass.set("multi.projects.AppKt")
}
```

- multiple subprojects

ã“ã¡ã‚‰ã®æ–¹ãŒã‚€ã—ã‚ã‚·ãƒ³ãƒ—ãƒ«ã«ãªã£ã¦ã„ã¾ã™ã­ã€‚ãªãœã§ã—ã‚‡ã†ã€‚
ç­”ãˆã¯ã€å„ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãŒå…±é€šã—ã¦ä¾å­˜ã™ã‚‹ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚„ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ `kotlin-common-conventions.gradle.kts` ã§å®šç¾©ã—ã¦ã„ã‚‹ãŸã‚ã§ã™ã€‚

```
/*
 * This file was generated by the Gradle 'init' task.
 */

plugins {
    id("multi.projects.kotlin-application-conventions")
}

dependencies {
    implementation("org.apache.commons:commons-text")
    implementation(project(":utilities"))
}

application {
    // Define the main class for the application.
    mainClass.set("multi.projects.app.AppKt")
}
```

ä¸‹è¨˜ãŒ `kotlin-common-conventions.gradle.kts` ã®ä¸­èº«ã§ã™ã€‚

```
/*
 * This file was generated by the Gradle 'init' task.
 */

plugins {
    // Apply the org.jetbrains.kotlin.jvm Plugin to add support for Kotlin.
    id("org.jetbrains.kotlin.jvm")
}

repositories {
    // Use Maven Central for resolving dependencies.
    mavenCentral()
}

dependencies {
    constraints {
        // Define dependency versions as constraints
        implementation("org.apache.commons:commons-text:1.9")

        implementation("org.jetbrains.kotlin:kotlin-stdlib-jdk8")
    }

    // Align versions of all Kotlin components
    implementation(platform("org.jetbrains.kotlin:kotlin-bom"))

    // Use the Kotlin JDK 8 standard library.
    implementation("org.jetbrains.kotlin:kotlin-stdlib-jdk8")

    // Align versions of all Kotlin components
    implementation(platform("org.jetbrains.kotlin:kotlin-bom"))

    // Use JUnit Jupiter API for testing.
    testImplementation("org.junit.jupiter:junit-jupiter-api:5.7.1")

    // Use JUnit Jupiter Engine for testing.
    testRuntimeOnly("org.junit.jupiter:junit-jupiter-engine")
}

tasks.test {
    // Use junit platform for unit tests.
    useJUnitPlatform()
}
```

ã„ã¾ã•ã‚‰ã§ã™ãŒã€Gradle ãƒãƒ«ãƒãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œã‚‹ã®ãŒæ¥½ã ã£ãŸã¨ã„ã†ã“ã¨ã§ã€‚ã¨ãã¨ã°ã«å¿œã˜ã¦ä½œã‚Šåˆ†ã‘ã¦ã„ãã¾ã—ã‚‡ã†ã€‚
